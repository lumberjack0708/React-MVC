# 購物車功能測試指南

## 🧪 測試環境準備

### 前置條件
1. 確保後端伺服器運行正常
2. 確保資料庫包含購物車相關資料表
3. 確保有測試用戶帳號和商品資料
4. 前端開發伺服器正常運行

### 測試用戶建議
- 建議使用多個測試帳號測試不同用戶的購物車隔離
- 確保測試商品有足夠的庫存數量

## 🛒 購物車功能測試清單

### 1. 加入購物車功能測試

#### 在商品頁面 (`/products`)
- [ ] **未登入用戶**：點擊「加入購物車」應顯示登入提示
- [ ] **已登入用戶**：
  - [ ] 點擊「加入購物車」按鈕
  - [ ] 檢查是否顯示成功通知
  - [ ] 重複點擊同一商品，數量應累加
  - [ ] 嘗試加入超過庫存數量的商品，應顯示錯誤訊息

#### 在首頁推薦商品
- [ ] 測試流程與商品頁面相同

#### 在商品詳情彈窗
- [ ] 開啟商品詳情 → 點擊「加入購物車」
- [ ] 確認功能正常運作

### 2. 購物車頁面功能測試 (`/cart`)

#### 頁面載入測試
- [ ] **未登入用戶**：應顯示登入提示頁面
- [ ] **已登入且購物車為空**：應顯示空狀態頁面
- [ ] **已登入且有商品**：
  - [ ] 正確顯示商品列表
  - [ ] 顯示正確的用戶資訊
  - [ ] 顯示購物車統計資訊（商品數量、總金額）

#### 商品數量操作測試
- [ ] **增加數量**：點擊 `+` 按鈕，數量增加
- [ ] **減少數量**：點擊 `-` 按鈕，數量減少
- [ ] **直接輸入數量**：在數字輸入框輸入新數量
- [ ] **數量為0**：數量減到0時，商品應自動移除
- [ ] **超過庫存**：嘗試輸入超過庫存的數量，應顯示錯誤
- [ ] **負數或無效值**：輸入負數或無效值，應正確處理

#### 移除商品測試
- [ ] 點擊刪除按鈕，出現確認彈窗
- [ ] 確認刪除，商品移除成功
- [ ] 取消刪除，商品保留

#### 清空購物車測試
- [ ] 點擊「清空購物車」按鈕，出現確認彈窗
- [ ] 確認清空，所有商品移除，顯示空狀態
- [ ] 取消清空，購物車保持原狀

#### 價格變動提醒測試
- [ ] 如果商品價格發生變化，應顯示價格變動提醒
- [ ] 購買價格 vs 目前價格的對比顯示

### 3. 結帳功能測試

#### 結帳流程測試
- [ ] 購物車有商品時，點擊「立即結帳」
- [ ] 檢查訂單資料是否正確發送到後端
- [ ] 成功結帳後應顯示訂單編號
- [ ] 結帳成功後購物車應自動清空
- [ ] 庫存應正確扣減

#### 異常情況測試
- [ ] 購物車為空時點擊結帳，應顯示提示訊息
- [ ] 結帳過程中網路中斷，應顯示錯誤訊息
- [ ] 商品庫存不足時結帳，應顯示相應錯誤

### 4. 購物車數量徽章測試 (如果已整合到導航欄)

- [ ] 加入商品後，徽章數量正確更新
- [ ] 移除商品後，徽章數量正確減少
- [ ] 清空購物車後，徽章隱藏或顯示0
- [ ] 多個瀏覽器標籤頁間的數量同步（30秒自動刷新）

## 🔧 API直接測試 (使用Postman或類似工具)

### API端點測試
所有API都使用POST方法，Content-Type: `application/x-www-form-urlencoded`

#### 1. 獲取購物車 - `getCart`
```
POST /backend/public/index.php?action=getCart
Body: account_id=1
```

#### 2. 加入購物車 - `addToCart`
```
POST /backend/public/index.php?action=addToCart
Body: account_id=1&product_id=1&quantity=2
```

#### 3. 更新商品數量 - `updateCartItem`
```
POST /backend/public/index.php?action=updateCartItem
Body: account_id=1&cart_item_id=1&quantity=3
```

#### 4. 移除商品 - `removeFromCart`
```
POST /backend/public/index.php?action=removeFromCart
Body: account_id=1&cart_item_id=1
```

#### 5. 清空購物車 - `clearCart`
```
POST /backend/public/index.php?action=clearCart
Body: account_id=1
```

#### 6. 獲取購物車統計 - `getCartStatistics`
```
POST /backend/public/index.php?action=getCartStatistics
Body: account_id=1
```

### 預期回應格式
所有API都應返回以下格式：
```json
{
  "status": 200,
  "message": "操作成功",
  "result": { /* 具體資料 */ }
}
```

## 🐛 常見問題排除

### 前端問題
1. **加入購物車沒反應**：檢查瀏覽器控制台錯誤訊息
2. **購物車頁面載入失敗**：檢查用戶登入狀態和API連接
3. **數量更新失敗**：檢查庫存是否足夠

### 後端問題
1. **API返回400錯誤**：檢查參數是否正確傳遞
2. **資料庫連接問題**：檢查資料庫配置
3. **購物車資料表問題**：確認資料表結構正確

### 資料同步問題
1. **購物車數量不同步**：刷新頁面或等待自動刷新
2. **價格不一致**：檢查商品價格是否有更新

## 🎯 測試完成確認

- [ ] 所有基本功能正常運作
- [ ] 錯誤處理機制有效
- [ ] 使用者體驗良好
- [ ] API回應時間在可接受範圍內
- [ ] 購物車資料持久化正確
- [ ] 多用戶購物車隔離正確

完成所有測試項目後，購物車功能即可投入生產使用！ 